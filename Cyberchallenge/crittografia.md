# Diffie-Hellman e crittografia asimmetrica

## Crittografia asimmetrica

il problema della crittorgafia simemtrica è lo scambio delle chiavi. Se non c'è un canale di comunicazione esistente sicruro, non c'è modo di essere sicuri che la chiave non venga vvista da terzi, al massimo sarebbe da trovarsi di persona.
Altro problema: se ci sono N persone che devono comunicare, e vogliono comunicare tra di loro anche a coppie, non c'è altro modo se non quelo di creare una chiave per ogni coppia, e anche qui ogni coppia dovrebbe trovarsi. Cioè, la chiave deve essere diversa per ogni persona con cui parlo. figurarsi cosa significa se devo parlare con 1000 persone (e ognuno deve ricordarsi N-1 chiave)

Soluzione banalissima è una trusted third party che gestisce le chiavi tra utenti. 
tra A e il tezo (TTP) c'è un canale, idem tra ttp e b. a parla con ttp col suo canale e ttp inoltra a c sul suo canale
* il ttp deve essere sempre raggiungibile
* singolo point of failure molto pericoloso
* ttp vede in chiaro tutte le comunicazioni -> attaccante o pressioni governative

## Diffie Hellman
permette di arrivare ad avere una chiave condivisa tra due interlocutori con un canale di comunicazione vulnerabile inizialmente. alla fine del processo arrivano ad avere una chiave condivisa che nessun altro potrà aver intercettato
* A e Bob scelgono pubblicamente un numeroo primo *p* e un generatore appartenente a N, minore di p
* alice e bob generano *a* e *b*, appartenenti al range [2,p]. 
* Alice calcola $A = g^a \mod p$ e analiogamente fa Bob con B
* Alice conosce a e B, così può calcolare $B^a = g^{ab} \mod p$
* bob conosce b e A così può calcolare simmetricamente $A^b = g^{ab} \mod p$
* così **entrambi hanno $g^{ab}$, che è il loro segreto, partendon solamente da rispettivamente da *p, g, a, B* e *p, g, b, A*.

La sicurezza non è molto efficiente: un p di 1024 bits equivale alla stessa difficoltà di bruteforce di un cifrario simmetrico con 80 bit di chiave. 
per avere una sicurezza simile a AES128 servono 3072. Con chiavi su curve ellittiche, 256 bit equivalgono di nuovo a AES 128

### MITM
Alice vuole iniziare una counicazione con bob. Alice genera una chiave e la stabilisce con Eve che si è messo in mezzo. stessa roba fa bob con eve. Alice manda mess, Eve lo decifra, lo legge (o anche modifica) e lo ricifra con la chiave di bob. NOn c'è modo di garantire che la persona con cui stai parlando sia effettivamente quella che ti aspetti.

## Crittografia Asimmetrica
finora abbiamo visto
* chiave simmetrica
* chiave simmetrica + scambio sicuro
  
Ora parliamo di crittografi a chiave pubblica. Non si parla più di chiave condivisa, ma di due chiavi diverse.
Si prende una chiave privata, usata per decifrare messaggi cifrati o per firmare un messaggio.
Da essa si deriva la chiave pubblica, usata per cifrare i messaggi e per verificare la firma.
Non c'è quindi bisogno di un TTM, non bisogna avere fiducia in terze parti. Risolve anche il problema di autenticazione: se sono sicuro della tua chiave pubblica, posso verificare la firma/certificato digitale. Ovviamente la premessa è che nessuno abbia scambiato la chiave.

Per fare questo, non deve esserci possibilità di ricavare la chiave privata da quella pubblica (funzioni one-way: facili in un verso, intrattabili da invertire). 
Riusciamo a:
* garantire confidenzialità
* garantire autenticazione
* garantire l'integrità del messaggio, con un mix dei due intelligente (cifro il messaggio e lo firmo pure)

### RSA
Torna l'elevamento a potenza con modulo.
per invertire sta cosa serve la scomposizione in fattori primi, sempre non trattabile
definiamo:
$$ \phi(n) = ({n \in \N : x<n \land gcd(x, n) = 1}) $$ 
è importante da ricorda re che 
* $ \phi(p) = p-1 $
* $ \phi(ab)  = \phi(a)\phi(b) $
* $ n = p*q $
* da cui $ \phi(n) = (p-1)*(q-1) $ù
il teorema di eulero fermat ci dice che se a e n sono coprimi,$ a^{\phi(n)} = 1 mod n $

ciò signfica che, sempre modulo n, $ a^x = a^y \implies x=n \mod \phi(n) $

#### algoritmo
1. prendo due numeri primi p, q
2. computo $ n = p*q $, il nostro modulo
3. computo $ phi(n) = (p.1)(q-1) $
4. scelgo un esopnente $ e >1 $ compreso tra $ 2,  phi(n) $ e che sia coprimo di n. $ e $ è la nostra chiave pubblica.
5. derivo d risolvendo l'equazione $ e*d = 1 \mod \phi(n) $

ora: 
$ M $ è il messaggio in chiaro come fosse un intero. un mio amico prende la mia chiave pubblica $ e $ per computare $ c = M^e \mod n $. C è il messaggio cifrato
io ricevo $ C $ e calcolo $ C^d \mod n $, e ricevo di nuovo $ M $

Nella pratica, vengono usati alcuni valori specifici di $ e $ per renderlo più efficiente (nella rappresentazione binaria deve essere abbastanza piccolo e con pochi "1" nella rappresentazione binaria. spesso si usa $ 65537 = 2^{16} +1 $) 

##### In python:
è comodo perchè `int` ha lunghezza arbitraria nativamente e contiene la funziona `pow(base, exp, modulus)` che oltre ad avere già il modulo, calcola anche l'inverso modulare se l'esponente è -1

```py
from Crypto.Util.number import getStrongPrime

p, q = getStrongPrime(1024), getStrongPrime(1024)
n, phi = p*q, (p-1)*(q-1)
e, d = 65537, pow(65537, -1, phi)

def encrypt(pt) : 
    return pow(pt, e, n)

def decrypt(ct): 
    return pow(ct, d, n)
```
#### attacchi
cosa potrebbe andare storto?
la sicurezza risiede nel fatto che è difficile fattorizzare n = pq.
**cosa succede se due numeri primi sono vicini tra loro?**
possiamo prendere il punto medio tra p e q, chiamiamolo a. la distanza pa = aq = b. 
quindi, $ p = a-b $ e $ q = a+b $ 
da cui $ N = pq = (a-b)(a+b) = a^2 -b^2 $. cioè esiste il quadrato di qualcosa che differisce da N di un altro quadrato. possiamo andare alla ricerca di numeri che sono il quadrato di qualcosa che si avvicinino a N e calcolare la differenza con N. Nel momento in cui troviamo che il risultato della differenza è un quadrato perfetto, abbiamo di fatto fattorizzato N e risolto p e q.
**riutilizzo dei numeri primi**
supponiamo di generare:
1. $ N_1  = p\cdot q $
2. $ N_2 = p \cdot r $
calcolo $ \gcd(a, b) $ e ho risolto

se il target genera molte chiavi, è conveniente continuare a testare gli mcd delle varie coppie, dal momento che c'è una probabilità via via crescente di riutilizzo dei primi.

**riutilizzo del modulo**
Se usiamo lo stesso esponente, non succede nulla.
se usiamo esponenti diversi, siam fottuti

* supponiamo di aver usato $ (N, e_1), (N, e_2) $ per cifrare lo stesso testo. otteniamo $ c_1,c_2 $
* supponiamo di aver usato $ xgcd(e_1,e_2) = (1,u,v) $ : questo significa che $ u*e_1 + v*e_2 = GCD $
* da qui il trick: $ c_1^u \cdot c_2^v = m^{e_1u} \cdot m^{e_2v} = m(\mod n) $


#### In pratica
**mcd** lo si ha nella stdlib di python con la funzione `gcd`. se il MCD è 1, allora a, b sono coprimi. se a e b sono primi, sono anche coprimi tra loro. L'algo di euclide è sta cosa:
```pseudo
finché il divisore è diverso da 0
    calcola la divisione intera
    il divsore diventa il dividendo 
    il resto diventa il divisore
restituisci il dividendo
```
```py
def my_mcd(a, b):
    while b != 0:
        q,r = divmod(a,b)
        a, b = b, r
    return a
```
si può estendere per avere dei coefficienti
```py
def xgcd(a, b):
    s0, s1, t0, t1 = 1, 0, 0, 1 #
    while b != 0:
        q,r = divmod(a,b)
        a, b = b, r
        s0, s1 = s1, (s0 - q*s1)
        t0, t1 = t1, (t0 - q*t1)
    return a, s0, t0
```
cosa sono `s0, t0`? 
sono i numeri che, moltiplicati per il dividendo e il divisore, danno il mcd.
per esempio:
`xgcd(13, 17) -> (1, 4, -3).` cioè, sono primi tra loro e `4*13 + (-3)*17 = 1`
Se ci si pensa, ogni volta che si fa un'operazione che va in overflow su un int, è equivalente a un'operazione modulare: si prende il resto di $ 2^{32} $. 
due numeri tra loro congruenti in aritmetica modulare rimangono tali anche se si fanno operazioni.

$ 26 \equiv 5 \mod 21 $,
$ 26 \cdot 7 \equiv 5 \cdot 7 \mod 21 $

**due esercizi**:
$ 11 \equiv x \mod 6 \implies x = 5 $
$ 8146798528947 \equiv x \mod 6 \implies x = 3$

**teorema di fermat**:
$ p $ definisce un campo finito (Finite Field) su cui sono definite alcune operazioni aritmetiche. 

abbiamo un campo con $ p=17 $. Calcoliamo $ 3^{17} \mod 17 $:  otteniamo 3. facendo altre prove osserviamo una certa regolarità: per ogni base della potenza, se il modulo e l'esponente coincidono, il risultato è la base. sta cosa è sempre vera.
$ 7^{17} \equiv 7 \mod 17 $
$ 7^{-1} \cdot 7^{17} \equiv 7^{-1} \cdot 7\mod 17 $
$ 7^{16} \equiv 1 \mod 17 $
abbiamo scoperto che 
```py
a ** p % p = a
a ** (p-1) % p = 1
```
**altra proprietà: inverso moltiplicativo**
$$ \forall g \in F_p \quad  \exists \ d \in \Z : g \cdot d \equiv 1 \mod p $$ 
questo è l'inverso moltiplicativo di g.
per esempio, $ 7 \cdot 8 = 56 \equiv 1 \mod 11 $
qual è l'inverso $ d = 3^{-1} : 3 \cdot d \equiv 1 \mod 13 $ ?
l'inverso è quel numero che moltiplicato per x ci dà 1. lo si fa calcolando l'algoritmo di euclide esteso, che ci dà i coefficienti.
```py
>>> # 7 * inv(7) ?
>>> p = 17
>>> xgcd(7, p)
(1, 5, -2)
>>> # quindi è 5
>>> 7*5
35
>>> 35 % p
1
```
vediamo di applicare ste cose a rsa:
cyberchallenge: CR_2.02 - Decrypt-me 1
```python
>>> n = 6978643725301034687
>>> e = 65537
>>> c = [330491619614655704,330491619614655704,3091954281444416978,466972204857341594,6003475009957582261,5339981105013139679,6596974661489421904,2822161913993247701,5547032995651184365,3269518217593410063,3736400100981045498,3616150431731140245,4136155834429311356,1488012991442385800,5547032995651184365,4136155834429311356,4971367358312153171,5547032995651184365,4158822776603671884,3616150431731140245,6596974661489421904,5465781155217766773,1488012991442385800,5547032995651184365,2822161913993247701,6596974661489421904,4136155834429311356,3491402966579516587,6596974661489421904,886641009203121273,4693728892056613413]
>>> n.bit_length()
63
>>> from sympy import primefactors
>>> p,q = primefactors(n)
>>> phi = (p-1) * (q-1)
>>> d = pow(e, -1, phi)
>>> m = [pow(x, d, n) for x in c]
>>> ''.join(chr(x) for x in m)
```

cyberchallenge: CR_2.02 - Decrypt-me 2

```python
n = 26031365670619051180967497992735653615248347404890934345824218269609007356758359436213558544987397749139905763394532981794461894107346439762361343384342120326551201048068380348814787400805695670193337789414404331146366248495562919707471218782167067150280336303081550451712162551574033500551802662825476272375858801622708133661521990104783247450632107891796484421088373022682857006604005171035765370581741766974684151952067307835338608090515755409851655727203230079645788957814681683283537936346193824177256316048319356777956436302270437852846483514349116717560705701369062182955707730027156063882547067131269501037097
e = 65537
c = [10864477714422251994390266296396345535725051916959924389076048139896979307593665356782546799562403294814334007912864773438784067241538879058044626735313614322467284063040994020766730365859011766322294194425625221689027234416090979658832489910231552800114071331052152339054632938737996407002327169431968793683293964270630788634884580198807181478044949457555436361993170542546607398654151588064893949079634286224646113144086115790434080296714961174787839236873550485286193900004898351840805361137479730073163088526940597011665078619032310982584228325093202451424448674668514898762417398816391110905070753608735794107170,10864477714422251994390266296396345535725051916959924389076048139896979307593665356782546799562403294814334007912864773438784067241538879058044626735313614322467284063040994020766730365859011766322294194425625221689027234416090979658832489910231552800114071331052152339054632938737996407002327169431968793683293964270630788634884580198807181478044949457555436361993170542546607398654151588064893949079634286224646113144086115790434080296714961174787839236873550485286193900004898351840805361137479730073163088526940597011665078619032310982584228325093202451424448674668514898762417398816391110905070753608735794107170,21461135210195487611535416749078994947612351915946256036739087855866197749657455482152105500637280636941418567706158741883158287759122232523282858307643755959649520070711586193807395063482559416653371913510727831191187392165667299269648097763978413068205106455926580973350387939769555058883313309488620624256681806594269153663495928639643860834458801460718887093829818657286924303090386276529662400169456692855046590803979876948626314200442202081829082196066705559580776836988626611661673904104156173431966682173738357964474964859982102601386407960103395069303651989124450479400293516004986062171660082867178497669863,11690830412271188080527749795755595174867619143676059538602657921359078655813546734262244716420710365244863506664946294591305635168134076352879926496728620427128343218241639573742777938559079430667058988131041579219001676929579494066204856634236623553203749922772441737300347095769657795879067315804182641426442392059791697216486151576820047787381430279736457057945610692027175032084878506245029517122593648147316137587483856722771874026496567933159846172484495390598810819058279465227077733285579623664209985662668303621887496558658516861209211077788850733748798837049729139256185479155294621527919099682905783243452,6574633691662772985731184404511670651603868020429019303627837734091996937637155460661817515268908351349190898081404525544355831057621375182259626444786267137036780572928066905152922783093116100198090465346888597360307633697742341269782028263659566528661506056942775743712742333328663574455793239337463112282991265133228765856623655349299251606888415130833712342657727864547838743070502066087205662351633410276169873158656172597651814860065728569170309219440861381060735021755965210454910877526545417069985302351233760105847461734589264071410213712381216063088471365790682143425154935867894619832439348130793156142233,13798621592577793944005192599019813232697016746886548534902166188004839619923956329587780235770688484797964428641237630399002794722287864505966932933281710290381525616265488281707334113863802152504159383477394105692647501587323962580635988260283628324939031183799248185860919594399959968979071195451648837069127033690802716095806056014875442238860014999886960962458840217456731147061769456334021251899919384594707008863081546747239575539135134861347195528245769752930171714368071818216649900686025691661476536711167454534844972905432583039884691748345300862071340364984833607116078599308869735155766466728834358561985,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,12744877102192770970523101838761673021244262637448229715039647382104092343105733178880372989995601058613966323792583374153909218869908403357794702532546292040471826766945664020694861204934525745178775560745068238095111260660923798529864433286525988163706619947908087571435662962510438542292725732237912306414295678020861712672734014710555773929287342838147009019158488416157800195959512337384159436390033352013155167601497666177688599600003110171258041308567195422227687470803173755525878728837410640013366393980122156655725127347826284659102753760323535718113266031334594732510678796211831877699164447935546741371081,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,15724273564713207129529836191590296044915642156557303918506854187212609053146450109431219060991054710901078702469058580740463194754009712922330854713200913551016228375873937415222450139689221982681585190090167633624191521231463736510392000026764520847794538950534227239794010111536301975348757503592783983955144709866433769543508872621366447341607368701531334044198937480608913995491705040091342051191399234451947107473473568490146008442688478598386944150353050550365228660095837783495568316501843548903647255666941501383714347451164047256523480491574480910011570264156484821865657077446243174515542016535279606712081,13886185099447040570826288960166422704775831741758275473829134506469667156742420104003806157429640610839170370203577250400122857230779002489415718302858063086284836857949601007117746375708584185992752103431220356416587958406599232249821420559158994397870381812933167988346668231184075194958660790066785699884500308623721405966023272737176757078713404569647271849992920409877332612834098756861104229555180643780318083139625477196511133627519254045436390767126741763004010376903939485952315204046444266386746354280191358427078334704061528168050730311162665220776226827857673460193398814697806136099714150135565601446893,21924361269778339837858684542898421626187414921569327737997192109082961149648700900828802075064324914318260339168389506397034403335145538935517214624692205922857433319491884358410190104415454437461658637359181989639974345738395085722713451177881389949534500167431935935256392224977137978519171209752194631144672901025941777577700579898163987152364406282989581335838840842405867718789406786698178430846854459760920000794663242250569811498570767681805814182122711831086716341003941023779766851395058519831682712560954012254181399062505931509058026289940311919459558591110825516531521648178210133292036944824417882440725,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,17166313480486892931530696678305096707058558260518357093206709578758292324703840875618657125470925976339329660213081477534290480799586512408372781587150874823116666029246786970023054014929974157366102980117046853576425369166091725488067231168116526769327913063807151982644908513984610778614057608310099112779187201654982293952153441880726729219226717841673213844197025185261266966485482670463402957749538243883899863551852948077811910019292307641298504400245929073210116241136948633757298094426314323316645473814200433094689773068942748572060093737454056316107510563121565884252513833889713417280546340586116332430586,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,11374623997972776726654847695599420112953801511225717796634459669479154231652869034775109863567026419466590195475306518639428910921343670329872647584975909172138565613985303108046226145018686563616989143618550135009663855849958150356224180694413173985996967102823173475225854809359839706558308157757848985685039452827948781777503737807453268105131997618920417556207149563974484618029885579555003842842727519538633314485150289844636034192260429147898802957426713770533569517124244205102149846727964163042304710522611733716572632424120622000011055837793014582647236096405057850345003167193833180552798706604212594428206,12744877102192770970523101838761673021244262637448229715039647382104092343105733178880372989995601058613966323792583374153909218869908403357794702532546292040471826766945664020694861204934525745178775560745068238095111260660923798529864433286525988163706619947908087571435662962510438542292725732237912306414295678020861712672734014710555773929287342838147009019158488416157800195959512337384159436390033352013155167601497666177688599600003110171258041308567195422227687470803173755525878728837410640013366393980122156655725127347826284659102753760323535718113266031334594732510678796211831877699164447935546741371081,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,15724273564713207129529836191590296044915642156557303918506854187212609053146450109431219060991054710901078702469058580740463194754009712922330854713200913551016228375873937415222450139689221982681585190090167633624191521231463736510392000026764520847794538950534227239794010111536301975348757503592783983955144709866433769543508872621366447341607368701531334044198937480608913995491705040091342051191399234451947107473473568490146008442688478598386944150353050550365228660095837783495568316501843548903647255666941501383714347451164047256523480491574480910011570264156484821865657077446243174515542016535279606712081,13886185099447040570826288960166422704775831741758275473829134506469667156742420104003806157429640610839170370203577250400122857230779002489415718302858063086284836857949601007117746375708584185992752103431220356416587958406599232249821420559158994397870381812933167988346668231184075194958660790066785699884500308623721405966023272737176757078713404569647271849992920409877332612834098756861104229555180643780318083139625477196511133627519254045436390767126741763004010376903939485952315204046444266386746354280191358427078334704061528168050730311162665220776226827857673460193398814697806136099714150135565601446893,21924361269778339837858684542898421626187414921569327737997192109082961149648700900828802075064324914318260339168389506397034403335145538935517214624692205922857433319491884358410190104415454437461658637359181989639974345738395085722713451177881389949534500167431935935256392224977137978519171209752194631144672901025941777577700579898163987152364406282989581335838840842405867718789406786698178430846854459760920000794663242250569811498570767681805814182122711831086716341003941023779766851395058519831682712560954012254181399062505931509058026289940311919459558591110825516531521648178210133292036944824417882440725,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,481358742795269565268574259969931737374772777608042714086620047758539932891508080337150847465580569532299504443039667903377043336455874184709564831809158542725787259804359820751565305779057479155206207737705029676602312168499266383663658174839672821187998574292067312428697260012954580172824837677917343024174421004637566774138262477002684158010275115647706740099663411762700953303260515208097923728582482597241199630974724821273640718386531418506459278824858179000464486900898665450817102753023664131282983494872260859300726937070088992186977098382314364611425678842576044086218830662579895012304158929139473635702,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,18966588066537550803399991594883980365140838756475995193841407730365241922225287135314188118879536934293790503786716454403873390044252778456126504992437867897363145175733704706133207863626907226905807433913216626522137033294129021272321845767827604270657035685654560654435267634836524200903136200171453543309989895081700219622103633649670821949363395534495533314692977953667504047435007368013668465212155387407951638204234369456724713204843765578681164516815107865460556076797797142627327966505138143471876332397609402054609961074394776944356919133364539381204766369312926411829090269438850895473604256451429504595882,16989172052368168192940449157317777647516063498798465020099695648681656448945395896875355399320633957007938149743656263569954690740264378101375179011120689064572762009166532475226591210094528682152995461772379922833561106640547875805998113587332232693189417609809613058661097182378348890250833614443244616132289270602893417544659058361169519418312449549254870559933585321232533063644486168311951577220739207860988283103530876960051710527420596650733218127837689114900312304080358280904541621734390107632162255813905466930377449497267212931666838588276666851440085997303212483471617138425168526226417299309470407521793]

>>> n.bit_length(n)
2048
# cosa possiamo notare?
# prendevamo un unico intero, non una sequenza di caratteri
# perché non si fa carattere per carattere? perché avendo n ed e, sapendo che il valore ASCii di C è 67, 
# se facciamo pow(ord('C'), e, n) vediamo che è esattamente corrispondente al primo carattere della lista cifrata.
# possiamo fare un brute force del genere: una mappa che ad ogni carattere (256) associa il suo cifrato, e poi controllare carattere per carattere e ricostruire la scritta originale

>>> all_cts = [pow(i, e, n) for i in range (256)]
>>> ct_to_byte = {ct: i for i in enumerate(all_cts)}
>>> m = [ct_to_byte[x] for c in c]
>>> ''.join(chr(m) for x in m)
```
cyberchallenge: CR_2.04 - RS2A

```python
n = 89143641593174996017940829434512620472224212719309414452132595836026220427903487320145994697980651982586504529272767661555487338482783564424860474662728864727273993580514641009440479387474215286497920469499137949139655612482534401155809883650788060442770065019330384241207178840133249405439436496214028307558903734242093172998730879440661363638565003329426368977132976057381117500008934189745613221516544513088897518129440859518756071033568194072765218076133667694638728726443287851900688835938080123387337393462387971999466486709250841797151090540874529267419498338329387042916613083146322232965416622470175180495907743430928207190178789080163648956980077548725164945509668997957352565065365941457195088869603665129286984836792952175330148059378293202649610713572446104281953627989163859485809788808508534529382088091029311893877546583669928496131753084896411819111283062837536076097760085135992412357419561774991459364679835378229023651827107364565360470564651977131126249972290200870911790594913743365416646767857884901614015788665683936809635125758430261265314698098466094059017437368507646477819703333772656927273514343778076300501054023098959237661073008808162603803715204854674041298849906327433101431951012146985495761696367870636202433101361960626531600926348142089226552198325016919487083750374489915175146866153953735781193481225863312482746912826070856446017147809208460333465329313456535455411936007666276592807784175302044822812942479141626037467345477917321281968041172167384212163578257658480098463281481529344185464314996956903202741886322363438074048846810969993605250398067874876841896624103759460110133424828446810356511251290637743636702614183409991197132491575032562653418023395238437365608671140737743212645395637665694544881795680378218113444819654272727321072445927623648315543634115399551663510510735009384569247623659827431855711560072567876179851492489603910135190717108556764597233253240486389390643320276977726818025163050601640195450675677567227240411410779412826621028244616810433555533373165859867659781475202135633012093950050241606596357743280710872377776727787269924266524289879775918931638125115068012082514110296027304474289875338899839927318803719580838392092527967209138703512452980175031916627885371740515686162857561710587568854295969137154479177237177380425711176079879774111887004965360114290161247594614252139752042951129604433598880629673492659084063055136817622895706476020680778245545944356200807866648970359643982729489217922876388914990334641094906598976794816011323954673578775401227682807125101250910329421091332002553259830155614494471563564788639372860417136501602811385110297914078406187310233425260560208166547368508305114439695200276774956574553369183599031538963793443751389132785931400583759761329688811878041707652282301287881496588584959270290771909341163174019367385710360542113310489866571786757528552497260740725907099267133050539378588214119265553407800485956012897071160518447438688157842664409659729663838644168009746236157786265024829565917528621175431999886530297179524853203422517926325525973856980800009929571680708523445596309737166498443582703660487278503320404126167116825609252398952218982584267002404396262125673210079685035571771806049071996834889288105295449461079417309562186167517894706744964094448011591870153240384231867709576445763818898789909204583608413229433640492485167158187128576178732492022050179948556553185003868439821440412105961884570513216236564405911276816908917540908766337307171792823318966862301244071574549519086107627838844024147888183205462782131151279743220241080118178832528849478279898624288523002900825161697769734745725621783167394340435718725636973149265960393992982803414662669788693830305371461660492803601699066048539186277412941332469805288305513788946522052887729727457902735242025113943809287023506757501472605369924291550550767828325884976226423462622691574052383035493292680106711990702947156527902051216860850870758108902970671024186499777181388089151385892709970626904193691618526904210630678120735403118123535439246596030740162151650185349774268014558661317331447460771664818916530122300884284886337101065903844876378219496158306575618571119179385239049762182557943522765774767146505125117849797675232102348367863819241145558435654409025934827240995628479046632482776557441431256950838992871457427986657951956675210822565582665945622167638836037702141064014451547559700945267256958160256602259721359531500777466535303862656372761288300254233735763878304211184282168735778866744062452680956626464676516389026153592963535743681771531180886999926359749971591365201944501543757615412816526209817289582076963245251856730985817648973390825762653523636279683208836735678802993412956498927182293160041234640712051733146394236355520002411673955557279015169500889428326023497042992264435757322515845650489616672662183180638392895882814005861260974739307704463230242290002903216578356645936452580469214415932816346000289237
e = 7
c = 4646642449734441795234716931873293337783178140295369476477414842493124786921367410881883742032891927674175802184387462112160099639235866128869152699193604169126692210658727708932871872023684255128054850532442397694479339589044019605244318335689745815134153090707404781703605885093038671892987162453083145333870361779070165023194343649585368917744026385936244068253021787577318611063841675505845949101602680733302819197803902930243946808728999105280115072171655797971649055822574030686629682830354992117

>>> n.bit_length()
16381
>>> c.bit_length()
1667
>>> e
7
# abbiamo un piccolo esponente, un n molto grande e un testo cifrato piccolino. cosa ci può dire sta roba?
# c è definito come m**e mod n. se m è molto piccolo, e pure e lo è, uò essere che non abbiamo mai fatto l' "overflow". si potrebbe quindi controllare se effettivamente l'm è molto piccolo.
# cioè, se abbiamo m^e mod n = m^e = c, da cui m = radice_eesima(c)
>>> from sympy import integer_nthroot
>>> from Crypto.Util.number import long_to_bytes
>>> long_to_bites(integer_ntrooth(c, e))
```